<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>医生增加挂号</title>
    <link rel="stylesheet" href="../static/layui/css/layui.css">
    <script src="../static/js/jquery-3.5.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../static/js/jquery.cookie.js" type="text/javascript" charset="utf-8"></script>
    <script src="../static/layui/layui.js"></script>
    <script src="../static/js/doctorconfig.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>

<form class="layui-form"  action=""  lay-filter="form1">
    <!-- 提示：如果你不想用form，你可以换成div等任何一个普通元素  form1进行下方ajax中的取值判断-->
    <!-- 第一个信息将sid进行影藏 -->
<!--    <input type="text" name="stuNum" hidden="hidden" />-->

    <div class="layui-form-item">
        <label class="layui-form-label">病人姓名</label>
        <div class="layui-input-block">
            <input type="text" name="stuName" lay-verify="stuName" class="layui-input"  title="请填写姓名">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">病人账号</label>
        <div class="layui-input-block">
            <input type="text" name="stuNum" lay-verify="stuNum" class="layui-input"  title="请填写账号">
        </div>
    </div>


    <div class="layui-form-item">
        <label class="layui-form-label">挂号内容</label>
        <div class="layui-input-block">
            <select name="illType" id="illType" lay-verify="illType">
                <option value=""></option>
                <option value="外伤">外伤</option>
                <option value="内伤">内伤</option>
                <option value="感冒">感冒</option>
            </select>
        </div>
    </div>


    <div class="layui-form-item">
        <label class="layui-form-label">挂号日期</label>
        <div class="layui-input-block">
            <input type="text" name="illDate" id="illDate" autocomplete="off" class="layui-input" placeholder="yyyy-MM-dd">
        </div>
    </div>

    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn" lay-submit lay-filter="formDemo">提交挂号</button>
        </div>
    </div>
</form>

<script type="text/javascript">
    layui.use(['element','layer','laydate','jquery','form','form','upload'], function(){
        var form = layui.form; //只有执行了这一步，部分表单元素才会自动修饰成功
        var element = layui.element;
        var layer = layui.layer;
        var $ = layui.jquery;

        var laydate = layui.laydate;
        //var upload = layui.upload;
        var form = layui.form;


        //执行一个laydate实例
        laydate.render({
            elem: '#illDate' //指定元素
        });

        //获取从doctor.html中传入的cookie值，进行后续的ajax中的交互
        var docNum = $.cookie("docNum");
        //$("#docNum").text(docNum);

        // $.ajax({
        //     url: '../stuinfo/selectBystuNum?stuNum='+stuNum,
        //     method: 'get',
        //     success: function(data) {
        //         if(data.code==0){
        //             /* 表单赋值 */
        //             form.val('form1',{
        //                 stuName: data.data.stuName,
        //                 stuNum: data.data.stuNum,
        //             });
        //         }else{
        //             layer.alert(data.msg);
        //         }
        //     },
        //     error: function(data){
        //         layer.alert(data.msg);
        //     }
        // });

        /* 表单提交 */
        form.on('submit(formDemo)',function(data){
            $.ajax({
                url: '../register/insertRegister',
                method: 'post',
                data: data.field,
                success: function(data){
                    if(data.code==0){
                        layer.msg("挂号成功。", {
                            icon: 6,
                            time: 1200,
                            shade: 0.4
                        });
                    }else{
                        layer.msg("挂号失败，请重试");
                    }
                },
                error: function(){
                    layer.msg("服务器内部错误");
                }
            });
            return false; //去掉该行layer不关闭
        });
        //但是，如果你的HTML是动态生成的，自动渲染就会失效
        //因此你需要在相应的地方，执行下述方法来进行渲染
        form.render();//更新信息
    });
</script>
</body>
</html>