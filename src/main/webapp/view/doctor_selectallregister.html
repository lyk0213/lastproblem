<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>医生查看所有的挂号名单</title>
    <link   href="../static/layui/css/layui.css" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="../static/layui/layui.js"></script>
    <script type="text/javascript" src="../static/js/jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="../static/js/jquery.cookie.js"></script>
    <script type="text/javascript" src="../static/js/doctorconfig.js"></script>
</head>
<body>
<div>
    <div class="demoTable">
        <form class="layui-form"  lay-filter="form1">
            <div class="layui-form-item">

                    <div class="layui-inline">
                        <label class="layui-form-label">挂号日期</label>
                        <div class="layui-input-inline" style="width: 100px;">
                            <input type="text" name="Date1" id="Date1" autocomplete="off" class="layui-input" placeholder="yyyy-MM-dd">
                        </div>
                    </div>

                    <div class="layui-inline">
<!--                        <button class="layui-btn" type="button" id="searchBtn">查询</button>-->
                        <button class="layui-btn layuiadmin-btn-useradmin" lay-submit
                                lay-filter="LAY-user-front-search" type="button" id="searchBtn">
                            <i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>
                        </button>
                   </div>
                </div>
        </form>
    </div>

    <table id="registerinfo" lay-filter="registerinfo"></table>

    <script type="text/html" id="toolBar">
        <div class="layui-btn-container">
            <button class="layui-btn layui-btn-sm" lay-event="reloadTable" style="background-color:#FF5722;color:black;">刷新表格</button>
        </div>
    </script>

    <script type="text/html" id="barDemo">
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="doit">进行诊断</a>
    </script>

<!--    <script type="text/html" id="barDemo1">-->
<!--        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="doit1">开具处方单</a>-->
<!--    </script>-->
</div>


<script type="text/javascript">
    layui.use([ 'table','element','layedit', 'laydate','form','jquery'],function() {
        var table = layui.table;
        var layer = layui.layer;
        var layedit = layui.layedit;
        var laydate = layui.laydate;
        var form = layui.form;
        var element = layui.element;
        var $ = layui.jquery;
        //日期
        laydate.render({
            elem : '#Date1'
        });

        var docNum = $.cookie("docNum");
        $("#docNum").text(docNum);



        //数据表格数据渲染
        var tableIns = table.render({
            elem : '#registerinfo',
            toolbar : '#toolBar',
            height : 680,
            url : '../register/docquery',
            page : true, //开启分页
            cols : [ [ //表头
                {field : 'stuNum',title : '挂号用户id',width : 140,sort: true},
                {field : 'stuName',title : '挂号用户名',width : 140},
                {field : 'stuRegister',title : '挂号序列',width : 140},
                {field : 'illType',title : '挂号类型',width : 140},
                {field : 'illDate',title : '预约时间',width : 150},
                {field : 'treatmentType',title : '当前处理状况',width : 100},
                {fixed : 'right',width : 138,align : 'center',toolbar : '#barDemo'}
            ] ]
        });

        //{field : 'treatmentType',title : '当前处理状况',width : 100},

        /* 查询按钮 */
        $('#searchBtn').click(function(){
            layer.msg('请稍后...',{
                icon:16,
                time:800,
                shade:0,
            },function(){
                tableIns.reload({
                    where:{
                        illDate: $('#Date1').val(),
                    },page:{
                        page: 1
                    }
                })
            })
        });


        //监听表格工具头
        table.on('toolbar(registerinfo)', function(obj){
            var checkStatus = table.checkStatus(obj.config.id);
            switch(obj.event){
                case 'reloadTable': tableIns.reload();break;
            };
        });


        //监听表格按钮事件
        table.on('tool(registerinfo)',function(obj){
            var data = obj.data; //获取表格行数据
            if(obj.event == 'doit'){
                // obj.del();
                // deleteRegister(data);
                addMedicRecord(data);
            }
        });


        function addMedicRecord(data) {
            layer.open({
                type: 2,
                title: '增加病历单信息',
                area: ['800px','550px'],
                fixed: false,
                maxmin: true,
                content: 'doctor_addMedicRecord.html',
                success: function(layero,index){
                    var body = layer.getChildFrame('body',index);
                    body.find('#stuRegister').val(data.stuRegister);//传递病历单号到子页面
                }
            })

        };





        // function deleteRegister(data){
        //     //controller还未进行编写，只是写了前端的页面部分
        //     $.ajax({
        //         url: '../register/registerdown?stuRegister='+data.stuRegister,
        //         success: function(data1) {
        //             if (data1.code == 0) {
        //                 layer.msg("挂号单: <b style='color:yellow'>"+data.stuRegister+"</b> 删除完成");
        //             } else {
        //                 layer.alert("请求失败，请稍后重试");
        //             }
        //         },
        //
        //         error: function(data1) {
        //             layer.alert("服务器内部错误");
        //         }
        //     })
        // }


    });
</script>





</body>
</html>